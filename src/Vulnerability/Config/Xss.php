<?php
namespace Phulner\Vulnerability\Config;

use Phulner\Vulnerability\ConfigAbstract;
use Phulner\Injector;
use Phulner\NodeVisitor\Scope;
use Phulner\Function_\Sanitizer\Factory;

class Xss extends ConfigAbstract {

    public function getInjector ($partConfig) {
        $injector = new Injector\Xss;

        $scope = new Scope;
        foreach ($partConfig->initialScope as $var) {
            $scope->addFromConfig($var);
        }
        $injector->setInitialScope($scope);

        $factory = new Factory;
        $injector->setSanitationFunctionsFactory($factory);

        return $injector;

    }

}

?>
